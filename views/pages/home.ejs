<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>
      <% if (locals.title) { %> <%= title.toUpperCase() %> - Urban Escape<%
      }else{%>Urban Escape<%}%>
    </title>
    <link rel="stylesheet" href="/css/style.css" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/notyf@3/notyf.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
    />
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  </head>
  <body style="margin: 0">
    <div class="fullscreen-toggle">
      <div class="fullscreen p-2 bg-primary text-white">
        <span>Enter Full Screen Experience</span>
      </div>
    </div>
    <div id="map" style="height: 100vh; width: 100vw"></div>
    <div class="simpleLoading">
      <div class="loadingAnime"></div>
    </div>
    <div class="loadingScreen">
      <div class="icon-container">
        <img alt="Map Icon" src="/images/marker.png" width="100px" />
      </div>
      <div class="text-container">
        <h2>Please Wait......</h2>
        <p>Ensure You have enabled your location for a better experience</p>
        <% if (locals.mapParsed) { %>
        <input type="hidden" id="mapParsedId" value="<%= mapParsed %>" />
        <% } %>
      </div>
    </div>
    <div class="errorScreen" style="display: none">
      <div class="icon-container">
        <img alt="Map Icon" src="/images/marker.png" width="100px" />
      </div>
      <div class="text-container">
        <h2>Location Error</h2>
        <p class="locerrmsg">
          Ensure You have enabled your location for a better experience
        </p>
      </div>
    </div>
    <div class="WinScreen" style="display: none"></div>
    <%- include('../components/navbar') %>
    <div
      class="modal fade"
      id="bsModal"
      tabindex="-1"
      aria-labelledby="bsModal"
      aria-hidden="true"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h1 class="modal-title fs-5" id="bsModalTitle">Congrats</h1>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body bsModalBody">
            <div
              class="multimodel"
              id="CapturedImagePopUp"
              style="display: none"
            >
              <div class="row m-0">
                <div class="col-md-5">
                  <div
                    class="h-100 d-flex justify-content-center align-items-center"
                  >
                    <img src="" width="100%" />
                  </div>
                </div>
                <div class="col-md-7 text-center">
                  <div class="h-100 d-flex align-items-center">
                    <p class="alert alert-warning w-100" id="captureMessage">
                      Captured Successfully into Profile Collections!
                    </p>
                  </div>
                </div>
                <div class="col-md-12 text-center mt-2">
                  <button class="btn btn-danger hideAllPopups">
                    Back to Map
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="mission-popup" style="display: none">
      <div class="col-11 col-sm-10 col-md-8 col-lg-6 col-xl-4">
        <div class="mission-container rounded-1">
          <div class="popup-header">
            <h1 class="text-center title">Missions</h1>
          </div>
          <div class="popup-body">
            <a
              href="javascript:voeed()"
              class="hideMissionsPopup btn btn-primary"
              >Close</a
            >
            <div class="missions-list">
              <ul></ul>
            </div>
            <div class="mission-interface" style="display: none">
              <a
                href="javascript:voeed()"
                class="backFromInterface btn btn-primary mt-2"
                >‚Üê</a
              >
              <div class="user-image-pick"></div>
              <div class="text-center placeholder-div-redeem">
                <p class="text-danger mt-3">
                  The Redeem button Activates after matching
                </p>
                <button class="btn btn-primary" disabled>REDEEM</button>
              </div>
            </div>
            <div class="mission-selector" style="display: none">
              <a href="javascript:console.log();" class="backFromInterface"
                >Back</a
              >
              <div class="captured_image"></div>
            </div>
            <div
              class="redeem-action-bar text-center mt-3"
              style="display: none"
            >
              <button class="btn btn-primary redeembtn">REDEEM</button>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div
      class="informationWindow position-fixed vh-100 z-3 vw-100 top-0 start-0"
      style="
        display: none;
        background: linear-gradient(45deg, #005c5c, #00004a);
      "
    >
      <div class="row justify-content-center align-items-center vh-100">
        <div class="col-11 col-sm-10 col-md-8 col-lg-6 col-xl-4">
          <div
            class="body text-center bg-white border-1 rounded-2 p-2"
            style="max-height: 90vh; overflow-y: scroll"
          >
            <h3 class="infoTitle pb-2 border-bottom">AJAY</h3>
            <img
              class="img-thumbnail infoBoxMarkimage my-2"
              src=""
              loading="lazy"
              width="100%"
            />
            <p class="alert alert-info" style="text-transform: capitalize">
              Lorem ipsum dolor sit amet consectetur adipisicing elit. Voluptas
              nesciunt mollitia quae, tempore sed neque eveniet numquam veniam
              architecto et eius aperiam ducimus. Ducimus, quibusdam
              repellendus? Fugit tenetur repudiandae nam.
            </p>
            <div class="row m-0 p-2 justify-content-center">
              <div
                class="my-2 col-sm-6 confirmCaptureContainer"
                style="display: none"
              >
                <% if(user){ %>
                <input type="hidden" id="isLogin" value="true" />
                <button class="btn w-100 btn-success confirmCapture">
                  Capture
                </button>
                <%}else{%>
                <button class="btn w-100 btn-secondary" disabled>
                  Capture
                </button>
                <%}%>
              </div>
              <div class="col-sm-6 my-2">
                <button class="btn w-100 btn-danger infodiscart">
                  Back to Map
                </button>
              </div>
              <% if(!user){ %>
              <div class="unauthinfo col-sm-12 my-2">
                <div class="m-0 text-center text-danger">
                  To activate the capture feature and join the game,
                  <a href="/auth#register">REGISTER</a> or
                  <a href="/auth#login">LOGIN</a>
                </div>
              </div>
              <% } %>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="currentLocationBtn" onclick="getCurrentLocation()">
      <img src="/images/aim.svg" class="image" />
    </div>
    <script>
      let missions=<%- JSON.stringify(missions) %>;
      let imageExists=<%- JSON.stringify(imageExist) %>;
    </script>
    <script src="/js/user.js"></script>
    <script src="https://maps.googleapis.com/maps/api/js?callback=initMap&v=beta&libraries=marker&key=<%= apiKey %>"></script>

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
      crossorigin="anonymous"
    ></script>
    <script src="https://cdn.jsdelivr.net/npm/notyf@3/notyf.min.js"></script>
  </body>
</html>
